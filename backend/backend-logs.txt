
> seguros-pro-backend@1.0.0 dev
> tsx watch src/index.ts

[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-11T19:18:35.630Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-11T19:18:35.646Z"}
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:error 
Invalid `prisma.task.create()` invocation in
/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.service.ts:51:24

  48   processedData.dueDate = new Date(processedData.dueDate)
  49 }
  50 
â†’ 51 return prisma.task.create({
       data: {
         title: "zxzxzx",
         description: null,
         priority: "MEDIA",
         dueDate: new Date("2026-02-12T00:00:00.000Z"),
         user: {
           connect: {
             id: 5
           }
         },
     +   company: {
     +     create: CompanyCreateWithoutTasksInput | CompanyUncheckedCreateWithoutTasksInput,
     +     connectOrCreate: CompanyCreateOrConnectWithoutTasksInput,
     +     connect: CompanyWhereUniqueInput
     +   }
       }
     })

Argument `company` is missing.
[31merror[39m: 
Invalid `prisma.task.create()` invocation in
/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.service.ts:51:24

  48   processedData.dueDate = new Date(processedData.dueDate)
  49 }
  50 
â†’ 51 return prisma.task.create({
       data: {
         title: "zxzxzx",
         description: null,
         priority: "MEDIA",
         dueDate: new Date("2026-02-12T00:00:00.000Z"),
         user: {
           connect: {
             id: 5
           }
         },
     +   company: {
     +     create: CompanyCreateWithoutTasksInput | CompanyUncheckedCreateWithoutTasksInput,
     +     connectOrCreate: CompanyCreateOrConnectWithoutTasksInput,
     +     connect: CompanyWhereUniqueInput
     +   }
       }
     })

Argument `company` is missing. {"stack":"PrismaClientValidationError: \nInvalid `prisma.task.create()` invocation in\n/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.service.ts:51:24\n\n  48   processedData.dueDate = new Date(processedData.dueDate)\n  49 }\n  50 \nâ†’ 51 return prisma.task.create({\n       data: {\n         title: \"zxzxzx\",\n         description: null,\n         priority: \"MEDIA\",\n         dueDate: new Date(\"2026-02-12T00:00:00.000Z\"),\n         user: {\n           connect: {\n             id: 5\n           }\n         },\n     +   company: {\n     +     create: CompanyCreateWithoutTasksInput | CompanyUncheckedCreateWithoutTasksInput,\n     +     connectOrCreate: CompanyCreateOrConnectWithoutTasksInput,\n     +     connect: CompanyWhereUniqueInput\n     +   }\n       }\n     })\n\nArgument `company` is missing.\n    at throwValidationException (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/core/errorRendering/throwValidationException.ts:45:9)\n    at ei.handleRequestError (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/RequestHandler.ts:202:7)\n    at ei.handleAndLogRequestError (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/RequestHandler.ts:174:12)\n    at ei.request (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/RequestHandler.ts:143:12)\n    at async a (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/getPrismaClient.ts:833:24)\n    at async create (/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.controller.ts:38:20)","timestamp":"2026-02-11T19:39:59.574Z"}
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:error 
Invalid `prisma.task.create()` invocation in
/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.service.ts:51:24

  48   processedData.dueDate = new Date(processedData.dueDate)
  49 }
  50 
â†’ 51 return prisma.task.create({
       data: {
         title: "zxzxzx",
         description: null,
         priority: "MEDIA",
         dueDate: new Date("2026-02-12T00:00:00.000Z"),
         user: {
           connect: {
             id: 5
           }
         },
     +   company: {
     +     create: CompanyCreateWithoutTasksInput | CompanyUncheckedCreateWithoutTasksInput,
     +     connectOrCreate: CompanyCreateOrConnectWithoutTasksInput,
     +     connect: CompanyWhereUniqueInput
     +   }
       }
     })

Argument `company` is missing.
[31merror[39m: 
Invalid `prisma.task.create()` invocation in
/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.service.ts:51:24

  48   processedData.dueDate = new Date(processedData.dueDate)
  49 }
  50 
â†’ 51 return prisma.task.create({
       data: {
         title: "zxzxzx",
         description: null,
         priority: "MEDIA",
         dueDate: new Date("2026-02-12T00:00:00.000Z"),
         user: {
           connect: {
             id: 5
           }
         },
     +   company: {
     +     create: CompanyCreateWithoutTasksInput | CompanyUncheckedCreateWithoutTasksInput,
     +     connectOrCreate: CompanyCreateOrConnectWithoutTasksInput,
     +     connect: CompanyWhereUniqueInput
     +   }
       }
     })

Argument `company` is missing. {"stack":"PrismaClientValidationError: \nInvalid `prisma.task.create()` invocation in\n/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.service.ts:51:24\n\n  48   processedData.dueDate = new Date(processedData.dueDate)\n  49 }\n  50 \nâ†’ 51 return prisma.task.create({\n       data: {\n         title: \"zxzxzx\",\n         description: null,\n         priority: \"MEDIA\",\n         dueDate: new Date(\"2026-02-12T00:00:00.000Z\"),\n         user: {\n           connect: {\n             id: 5\n           }\n         },\n     +   company: {\n     +     create: CompanyCreateWithoutTasksInput | CompanyUncheckedCreateWithoutTasksInput,\n     +     connectOrCreate: CompanyCreateOrConnectWithoutTasksInput,\n     +     connect: CompanyWhereUniqueInput\n     +   }\n       }\n     })\n\nArgument `company` is missing.\n    at throwValidationException (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/core/errorRendering/throwValidationException.ts:45:9)\n    at ei.handleRequestError (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/RequestHandler.ts:202:7)\n    at ei.handleAndLogRequestError (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/RequestHandler.ts:174:12)\n    at ei.request (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/RequestHandler.ts:143:12)\n    at async a (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/getPrismaClient.ts:833:24)\n    at async create (/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.controller.ts:38:20)","timestamp":"2026-02-11T19:39:59.849Z"}
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:error 
Invalid `prisma.task.create()` invocation in
/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.service.ts:51:24

  48   processedData.dueDate = new Date(processedData.dueDate)
  49 }
  50 
â†’ 51 return prisma.task.create({
       data: {
         title: "sdfd",
         description: null,
         priority: "MEDIA",
         dueDate: new Date("2026-02-11T00:00:00.000Z"),
         user: {
           connect: {
             id: 5
           }
         },
     +   company: {
     +     create: CompanyCreateWithoutTasksInput | CompanyUncheckedCreateWithoutTasksInput,
     +     connectOrCreate: CompanyCreateOrConnectWithoutTasksInput,
     +     connect: CompanyWhereUniqueInput
     +   }
       }
     })

Argument `company` is missing.
[31merror[39m: 
Invalid `prisma.task.create()` invocation in
/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.service.ts:51:24

  48   processedData.dueDate = new Date(processedData.dueDate)
  49 }
  50 
â†’ 51 return prisma.task.create({
       data: {
         title: "sdfd",
         description: null,
         priority: "MEDIA",
         dueDate: new Date("2026-02-11T00:00:00.000Z"),
         user: {
           connect: {
             id: 5
           }
         },
     +   company: {
     +     create: CompanyCreateWithoutTasksInput | CompanyUncheckedCreateWithoutTasksInput,
     +     connectOrCreate: CompanyCreateOrConnectWithoutTasksInput,
     +     connect: CompanyWhereUniqueInput
     +   }
       }
     })

Argument `company` is missing. {"stack":"PrismaClientValidationError: \nInvalid `prisma.task.create()` invocation in\n/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.service.ts:51:24\n\n  48   processedData.dueDate = new Date(processedData.dueDate)\n  49 }\n  50 \nâ†’ 51 return prisma.task.create({\n       data: {\n         title: \"sdfd\",\n         description: null,\n         priority: \"MEDIA\",\n         dueDate: new Date(\"2026-02-11T00:00:00.000Z\"),\n         user: {\n           connect: {\n             id: 5\n           }\n         },\n     +   company: {\n     +     create: CompanyCreateWithoutTasksInput | CompanyUncheckedCreateWithoutTasksInput,\n     +     connectOrCreate: CompanyCreateOrConnectWithoutTasksInput,\n     +     connect: CompanyWhereUniqueInput\n     +   }\n       }\n     })\n\nArgument `company` is missing.\n    at throwValidationException (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/core/errorRendering/throwValidationException.ts:45:9)\n    at ei.handleRequestError (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/RequestHandler.ts:202:7)\n    at ei.handleAndLogRequestError (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/RequestHandler.ts:174:12)\n    at ei.request (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/RequestHandler.ts:143:12)\n    at async a (/home/jaquezrd/Programas/seguros/backend/node_modules/@prisma/client/src/runtime/getPrismaClient.ts:833:24)\n    at async create (/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.controller.ts:38:20)","timestamp":"2026-02-11T19:40:52.621Z"}
[AUTH] Tenant context cleared after request
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
3:45:11 p.Â m. [tsx] change in ./src/modules/tasks/tasks.controller.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-11T19:45:12.344Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-11T19:45:12.362Z"}
3:45:20 p.Â m. [tsx] change in ./src/modules/tasks/tasks.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-11T19:45:20.586Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-11T19:45:20.604Z"}
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_days" IS NOT NULL) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2 AND "public"."payments"."due_date" >= $3 AND "public"."payments"."due_date" <= $4) OFFSET $5) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2) OFFSET $3) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2 AND "public"."payments"."due_date" >= $3 AND "public"."payments"."due_date" <= $4) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_days" IS NOT NULL) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2 AND "public"."payments"."due_date" >= $3 AND "public"."payments"."due_date" <= $4) OFFSET $5) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2) OFFSET $3) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2 AND "public"."payments"."due_date" >= $3 AND "public"."payments"."due_date" <= $4) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[RBAC] Access denied - User: hola@admin.com, Role: EJECUTIVO, Allowed roles: ADMINISTRADOR, Path: /
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[RBAC] Access denied - User: hola@admin.com, Role: EJECUTIVO, Allowed roles: ADMINISTRADOR, Path: /
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[RBAC] Access denied - User: hola@admin.com, Role: EJECUTIVO, Allowed roles: ADMINISTRADOR, Path: /
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[RBAC] Access denied - User: hola@admin.com, Role: EJECUTIVO, Allowed roles: ADMINISTRADOR, Path: /
[AUTH] Tenant context cleared after request
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[RBAC] Access denied - User: hola@admin.com, Role: EJECUTIVO, Allowed roles: ADMINISTRADOR, CONTABILIDAD, Path: /
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[RBAC] Access denied - User: hola@admin.com, Role: EJECUTIVO, Allowed roles: ADMINISTRADOR, CONTABILIDAD, Path: /
[AUTH] Tenant context cleared after request
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[RBAC] Access denied - User: hola@admin.com, Role: EJECUTIVO, Allowed roles: ADMINISTRADOR, Path: /
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[RBAC] Access denied - User: hola@admin.com, Role: EJECUTIVO, Allowed roles: ADMINISTRADOR, CONTABILIDAD, Path: /
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" WHERE 1=1 ORDER BY "public"."renewals"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" WHERE 1=1 ORDER BY "public"."renewals"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."company_id", "public"."insurance_types"."name", "public"."insurance_types"."category", "public"."insurance_types"."description" FROM "public"."insurance_types" WHERE 1=1 ORDER BY "public"."insurance_types"."name" ASC OFFSET $1
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" WHERE 1=1 ORDER BY "public"."renewals"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."company_id", "public"."insurance_types"."name", "public"."insurance_types"."category", "public"."insurance_types"."description" FROM "public"."insurance_types" WHERE 1=1 ORDER BY "public"."insurance_types"."name" ASC OFFSET $1
[AUTH] Tenant context cleared after request
[AUTH] Tenant context cleared after request
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."policies"."status"::text FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."claims"."status"::text FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all", SUM("public"."payments"."amount") AS "_sum$amount", "public"."payments"."status"::text FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."status" OFFSET $1
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2 AND ("j0"."status" <> CAST($3::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email" FROM "public"."clients" WHERE (NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) AND "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus")) ORDER BY "public"."clients"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") AND "public"."policies"."end_date" <= $2 AND "public"."policies"."end_date" >= $3) ORDER BY "public"."policies"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE "public"."claims"."status" = CAST($1::text AS "public"."ClaimStatus") ORDER BY "public"."claims"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."policies"."status"::text FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."status" OFFSET $1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all", SUM("public"."payments"."amount") AS "_sum$amount", "public"."payments"."status"::text FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."claims"."status"::text FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."status" OFFSET $1
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE "public"."claims"."status" = CAST($1::text AS "public"."ClaimStatus") ORDER BY "public"."claims"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") AND "public"."policies"."end_date" <= $2 AND "public"."policies"."end_date" >= $3) ORDER BY "public"."policies"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email" FROM "public"."clients" WHERE (NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) AND "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus")) ORDER BY "public"."clients"."id" ASC LIMIT $2 OFFSET $3
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2 AND ("j0"."status" <> CAST($3::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 791
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] User role from DB: EJECUTIVO
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: false
[AUTH] Role typeof: string
[AUTH] User companies count: 1
[AUTH] Tenant context set - CompanyId: 1, Role: EJECUTIVO
[AUTH] User authenticated - Email: hola@admin.com, Role: EJECUTIVO, CompanyId: 1, ID: 5
prisma:query SELECT 1
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."claims"."status"::text FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all", SUM("public"."payments"."amount") AS "_sum$amount", "public"."payments"."status"::text FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."policies"."status"::text FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."status" OFFSET $1
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" WHERE 1=1 ORDER BY "public"."renewals"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" WHERE 1=1 ORDER BY "public"."renewals"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" WHERE 1=1 ORDER BY "public"."renewals"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."company_id", "public"."insurance_types"."name", "public"."insurance_types"."category", "public"."insurance_types"."description" FROM "public"."insurance_types" WHERE 1=1 ORDER BY "public"."insurance_types"."name" ASC OFFSET $1
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."company_id", "public"."insurance_types"."name", "public"."insurance_types"."category", "public"."insurance_types"."description" FROM "public"."insurance_types" WHERE 1=1 ORDER BY "public"."insurance_types"."name" ASC OFFSET $1
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."commissions"."id", "public"."commissions"."company_id", "public"."commissions"."policy_id", "public"."commissions"."producer_id", "public"."commissions"."rule_id", "public"."commissions"."premium_amount", "public"."commissions"."rate", "public"."commissions"."amount", "public"."commissions"."period", "public"."commissions"."status"::text, "public"."commissions"."paid_date", "public"."commissions"."created_at" FROM "public"."commissions" WHERE 1=1 ORDER BY "public"."commissions"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."client_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email" FROM "public"."users" WHERE "public"."users"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."commissions"."id", "public"."commissions"."company_id", "public"."commissions"."policy_id", "public"."commissions"."producer_id", "public"."commissions"."rule_id", "public"."commissions"."premium_amount", "public"."commissions"."rate", "public"."commissions"."amount", "public"."commissions"."period", "public"."commissions"."status"::text, "public"."commissions"."paid_date", "public"."commissions"."created_at" FROM "public"."commissions" WHERE 1=1 ORDER BY "public"."commissions"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."client_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email" FROM "public"."users" WHERE "public"."users"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."commissions"."id", "public"."commissions"."company_id", "public"."commissions"."policy_id", "public"."commissions"."producer_id", "public"."commissions"."rule_id", "public"."commissions"."premium_amount", "public"."commissions"."rate", "public"."commissions"."amount", "public"."commissions"."period", "public"."commissions"."status"::text, "public"."commissions"."paid_date", "public"."commissions"."created_at" FROM "public"."commissions" WHERE 1=1 ORDER BY "public"."commissions"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."client_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email" FROM "public"."users" WHERE "public"."users"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_days" IS NOT NULL) OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2 AND "public"."payments"."due_date" >= $3 AND "public"."payments"."due_date" <= $4) OFFSET $5) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2 AND "public"."payments"."due_date" >= $3 AND "public"."payments"."due_date" <= $4) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2) OFFSET $3) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_days" IS NOT NULL) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2 AND "public"."payments"."due_date" >= $3 AND "public"."payments"."due_date" <= $4) OFFSET $5) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2 AND "public"."payments"."due_date" >= $3 AND "public"."payments"."due_date" <= $4) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] User role from DB: SUPER_ADMIN
[AUTH] UserRole.SUPER_ADMIN enum: SUPER_ADMIN
[AUTH] Role comparison result: true
[AUTH] Role typeof: string
[AUTH] User companies count: 2
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
8:09:12 p.Â m. [tsx] change in ./src/middleware/auth.middleware.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:09:12.713Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:09:12.729Z"}
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_1_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_2_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims", COALESCE("aggr_selection_3_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."companies" LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_0_Client" ON ("public"."companies"."id" = "aggr_selection_0_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_1_Policy" ON ("public"."companies"."id" = "aggr_selection_1_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_2_Claim" ON ("public"."companies"."id" = "aggr_selection_2_Claim"."company_id") LEFT JOIN (SELECT "public"."payments"."company_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."company_id") AS "aggr_selection_3_Payment" ON ("public"."companies"."id" = "aggr_selection_3_Payment"."company_id") WHERE ("public"."companies"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE "public"."company_users"."company_id" IN ($1) OFFSET $2
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_1_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_2_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims", COALESCE("aggr_selection_3_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."companies" LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_0_Client" ON ("public"."companies"."id" = "aggr_selection_0_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_1_Policy" ON ("public"."companies"."id" = "aggr_selection_1_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_2_Claim" ON ("public"."companies"."id" = "aggr_selection_2_Claim"."company_id") LEFT JOIN (SELECT "public"."payments"."company_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."company_id") AS "aggr_selection_3_Payment" ON ("public"."companies"."id" = "aggr_selection_3_Payment"."company_id") WHERE ("public"."companies"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE "public"."company_users"."company_id" IN ($1) OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."status"::text FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE "public"."company_users"."user_id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "name" = $1, "email" = $2, "role" = CAST($3::text AS "public"."UserRole"), "phone" = $4, "updated_at" = $5 WHERE ("public"."users"."id" = $6 AND 1=1) RETURNING "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."role"::text FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "active_company_id" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
[AUTH] Tenant context cleared after request
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."role"::text FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."user_id" = $1 AND "public"."company_users"."company_id" = $2 AND "public"."company_users"."is_active" = $3) LIMIT $4 OFFSET $5
prisma:query UPDATE "public"."users" SET "active_company_id" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email" FROM "public"."clients" WHERE (NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) AND "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus")) ORDER BY "public"."clients"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE "public"."claims"."status" = CAST($1::text AS "public"."ClaimStatus") ORDER BY "public"."claims"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") AND "public"."policies"."end_date" <= $2 AND "public"."policies"."end_date" >= $3) ORDER BY "public"."policies"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."claims"."status"::text FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."policies"."status"::text FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2 AND ("j0"."status" <> CAST($3::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT COUNT(*) AS "_count$_all", SUM("public"."payments"."amount") AS "_sum$amount", "public"."payments"."status"::text FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."status" OFFSET $1
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all", SUM("public"."payments"."amount") AS "_sum$amount", "public"."payments"."status"::text FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."policies"."status"::text FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."claims"."status"::text FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."status" OFFSET $1
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE "public"."claims"."status" = CAST($1::text AS "public"."ClaimStatus") ORDER BY "public"."claims"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") AND "public"."policies"."end_date" <= $2 AND "public"."policies"."end_date" >= $3) ORDER BY "public"."policies"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2 AND ("j0"."status" <> CAST($3::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email" FROM "public"."clients" WHERE (NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) AND "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus")) ORDER BY "public"."clients"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" WHERE 1=1 ORDER BY "public"."renewals"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" WHERE 1=1 ORDER BY "public"."renewals"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" WHERE 1=1 ORDER BY "public"."renewals"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT 1
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."commissions"."id", "public"."commissions"."company_id", "public"."commissions"."policy_id", "public"."commissions"."producer_id", "public"."commissions"."rule_id", "public"."commissions"."premium_amount", "public"."commissions"."rate", "public"."commissions"."amount", "public"."commissions"."period", "public"."commissions"."status"::text, "public"."commissions"."paid_date", "public"."commissions"."created_at" FROM "public"."commissions" WHERE 1=1 ORDER BY "public"."commissions"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."client_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email" FROM "public"."users" WHERE "public"."users"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."commissions"."id", "public"."commissions"."company_id", "public"."commissions"."policy_id", "public"."commissions"."producer_id", "public"."commissions"."rule_id", "public"."commissions"."premium_amount", "public"."commissions"."rate", "public"."commissions"."amount", "public"."commissions"."period", "public"."commissions"."status"::text, "public"."commissions"."paid_date", "public"."commissions"."created_at" FROM "public"."commissions" WHERE 1=1 ORDER BY "public"."commissions"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."client_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email" FROM "public"."users" WHERE "public"."users"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."commissions"."id", "public"."commissions"."company_id", "public"."commissions"."policy_id", "public"."commissions"."producer_id", "public"."commissions"."rule_id", "public"."commissions"."premium_amount", "public"."commissions"."rate", "public"."commissions"."amount", "public"."commissions"."period", "public"."commissions"."status"::text, "public"."commissions"."paid_date", "public"."commissions"."created_at" FROM "public"."commissions" WHERE 1=1 ORDER BY "public"."commissions"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."client_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email" FROM "public"."users" WHERE "public"."users"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."role"::text FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."user_id" = $1 AND "public"."company_users"."company_id" = $2 AND "public"."company_users"."is_active" = $3) LIMIT $4 OFFSET $5
prisma:query UPDATE "public"."users" SET "active_company_id" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email" FROM "public"."clients" WHERE (NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) AND "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus")) ORDER BY "public"."clients"."id" ASC LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE "public"."claims"."status" = CAST($1::text AS "public"."ClaimStatus") ORDER BY "public"."claims"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") AND "public"."policies"."end_date" <= $2 AND "public"."policies"."end_date" >= $3) ORDER BY "public"."policies"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2 AND ("j0"."status" <> CAST($3::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."policies"."status"::text FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."claims"."status"::text FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all", SUM("public"."payments"."amount") AS "_sum$amount", "public"."payments"."status"::text FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."status" OFFSET $1
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all", SUM("public"."payments"."amount") AS "_sum$amount", "public"."payments"."status"::text FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."policies"."status"::text FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."claims"."status"::text FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2 AND ("j0"."status" <> CAST($3::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email" FROM "public"."clients" WHERE (NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) AND "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus")) ORDER BY "public"."clients"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") AND "public"."policies"."end_date" <= $2 AND "public"."policies"."end_date" >= $3) ORDER BY "public"."policies"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE "public"."claims"."status" = CAST($1::text AS "public"."ClaimStatus") ORDER BY "public"."claims"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
8:32:13 p.Â m. [tsx] change in ./src/modules/auth/auth.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:32:13.802Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:32:13.821Z"}
8:32:24 p.Â m. [tsx] change in ./src/modules/auth/auth.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:32:24.887Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:32:24.903Z"}
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."role"::text FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "active_company_id" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 1, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 1, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2 AND ("j0"."status" <> CAST($3::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") AND "public"."policies"."end_date" <= $2 AND "public"."policies"."end_date" >= $3) ORDER BY "public"."policies"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE "public"."claims"."status" = CAST($1::text AS "public"."ClaimStatus") ORDER BY "public"."claims"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email" FROM "public"."clients" WHERE (NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) AND "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus")) ORDER BY "public"."clients"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1) OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."claims"."status"::text FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all", SUM("public"."payments"."amount") AS "_sum$amount", "public"."payments"."status"::text FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."policies"."status"::text FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."status" OFFSET $1
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all", SUM("public"."payments"."amount") AS "_sum$amount", "public"."payments"."status"::text FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."policies"."status"::text FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."status" OFFSET $1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all", "public"."claims"."status"::text FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."status" OFFSET $1
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") AND "public"."policies"."end_date" <= $2 AND "public"."policies"."end_date" >= $3) ORDER BY "public"."policies"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2 AND ("j0"."status" <> CAST($3::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."id" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email" FROM "public"."clients" WHERE (NOT EXISTS(SELECT "t0"."client_id" FROM "public"."policies" AS "t0" WHERE (1=1 AND ("public"."clients"."id") = ("t0"."client_id") AND "t0"."client_id" IS NOT NULL)) AND "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus")) ORDER BY "public"."clients"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE "public"."claims"."status" = CAST($1::text AS "public"."ClaimStatus") ORDER BY "public"."claims"."id" ASC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."company_id", "public"."insurance_types"."name", "public"."insurance_types"."category", "public"."insurance_types"."description" FROM "public"."insurance_types" WHERE 1=1 ORDER BY "public"."insurance_types"."name" ASC OFFSET $1
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."user_id", "public"."clients"."created_by", "public"."clients"."created_at", "public"."clients"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_Payment"."_aggr_count_payments", 0) AS "_aggr_count_payments" FROM "public"."clients" LEFT JOIN (SELECT "public"."policies"."client_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."client_id") AS "aggr_selection_0_Policy" ON ("public"."clients"."id" = "aggr_selection_0_Policy"."client_id") LEFT JOIN (SELECT "public"."payments"."client_id", COUNT(*) AS "_aggr_count_payments" FROM "public"."payments" WHERE 1=1 GROUP BY "public"."payments"."client_id") AS "aggr_selection_1_Payment" ON ("public"."clients"."id" = "aggr_selection_1_Payment"."client_id") WHERE "public"."clients"."status" <> CAST($1::text AS "public"."ClientStatus") ORDER BY "public"."clients"."created_at" DESC LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."company_id", "public"."insurance_types"."name", "public"."insurance_types"."category", "public"."insurance_types"."description" FROM "public"."insurance_types" WHERE 1=1 ORDER BY "public"."insurance_types"."name" ASC OFFSET $1
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."insurers"."id" FROM "public"."insurers" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at", COALESCE("aggr_selection_0_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_1_InsurerBranch"."_aggr_count_branches", 0) AS "_aggr_count_branches" FROM "public"."insurers" LEFT JOIN (SELECT "public"."policies"."insurer_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."insurer_id") AS "aggr_selection_0_Policy" ON ("public"."insurers"."id" = "aggr_selection_0_Policy"."insurer_id") LEFT JOIN (SELECT "public"."insurer_branches"."insurer_id", COUNT(*) AS "_aggr_count_branches" FROM "public"."insurer_branches" WHERE 1=1 GROUP BY "public"."insurer_branches"."insurer_id") AS "aggr_selection_1_InsurerBranch" ON ("public"."insurers"."id" = "aggr_selection_1_InsurerBranch"."insurer_id") WHERE 1=1 ORDER BY "public"."insurers"."name" ASC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" WHERE 1=1 ORDER BY "public"."renewals"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" WHERE 1=1 ORDER BY "public"."renewals"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" WHERE 1=1 ORDER BY "public"."renewals"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."commissions"."id", "public"."commissions"."company_id", "public"."commissions"."policy_id", "public"."commissions"."producer_id", "public"."commissions"."rule_id", "public"."commissions"."premium_amount", "public"."commissions"."rate", "public"."commissions"."amount", "public"."commissions"."period", "public"."commissions"."status"::text, "public"."commissions"."paid_date", "public"."commissions"."created_at" FROM "public"."commissions" WHERE 1=1 ORDER BY "public"."commissions"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."client_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email" FROM "public"."users" WHERE "public"."users"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") ORDER BY "public"."policies"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."commissions"."id", "public"."commissions"."company_id", "public"."commissions"."policy_id", "public"."commissions"."producer_id", "public"."commissions"."rule_id", "public"."commissions"."premium_amount", "public"."commissions"."rate", "public"."commissions"."amount", "public"."commissions"."period", "public"."commissions"."status"::text, "public"."commissions"."paid_date", "public"."commissions"."created_at" FROM "public"."commissions" WHERE 1=1 ORDER BY "public"."commissions"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."client_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE 1=1 ORDER BY "public"."policies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9)) OFFSET $10
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4,$5,$6,$7) OFFSET $8
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email" FROM "public"."users" WHERE "public"."users"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."insurance_types"."id", "public"."insurance_types"."name", "public"."insurance_types"."category" FROM "public"."insurance_types" WHERE "public"."insurance_types"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."payments"."id", "public"."payments"."status"::text, "public"."payments"."due_date", "public"."payments"."policy_id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."policy_id" IN ($2,$3,$4,$5,$6,$7,$8,$9,$10)) OFFSET $11
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."commissions"."id", "public"."commissions"."company_id", "public"."commissions"."policy_id", "public"."commissions"."producer_id", "public"."commissions"."rule_id", "public"."commissions"."premium_amount", "public"."commissions"."rate", "public"."commissions"."amount", "public"."commissions"."period", "public"."commissions"."status"::text, "public"."commissions"."paid_date", "public"."commissions"."created_at" FROM "public"."commissions" WHERE 1=1 ORDER BY "public"."commissions"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."commissions"."id" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."client_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email" FROM "public"."users" WHERE "public"."users"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."users"."id" FROM "public"."users" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE 1=1 ORDER BY "public"."users"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) ORDER BY "public"."payments"."created_at" DESC LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5,$6) OFFSET $7
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE (("j0"."status" <> CAST($1::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL)) AND "public"."payments"."status" = CAST($2::text AS "public"."PaymentStatus")) OFFSET $3) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."cedula_rnc" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2 AND "public"."payments"."due_date" >= $3 AND "public"."payments"."due_date" <= $4) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2 AND "public"."payments"."due_date" >= $3 AND "public"."payments"."due_date" <= $4) OFFSET $5) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_days" IS NOT NULL) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2) OFFSET $3) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2 AND "public"."payments"."due_date" >= $3 AND "public"."payments"."due_date" <= $4) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2 AND "public"."payments"."due_date" >= $3 AND "public"."payments"."due_date" <= $4) OFFSET $5) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_days" IS NOT NULL) OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."reminder_sent" = $2) OFFSET $3) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
[31merror[39m: No se puede crear una tarea sin contexto de empresa {"stack":"Error: No se puede crear una tarea sin contexto de empresa\n    at TasksService.create (/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.service.ts:47:13)\n    at create (/home/jaquezrd/Programas/seguros/backend/src/modules/tasks/tasks.controller.ts:39:34)\n    at Layer.handle [as handle_request] (/home/jaquezrd/Programas/seguros/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jaquezrd/Programas/seguros/backend/node_modules/express/lib/router/route.js:149:13)\n    at <anonymous> (/home/jaquezrd/Programas/seguros/backend/src/middleware/validation.middleware.ts:12:7)\n    at Layer.handle [as handle_request] (/home/jaquezrd/Programas/seguros/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jaquezrd/Programas/seguros/backend/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/home/jaquezrd/Programas/seguros/backend/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/home/jaquezrd/Programas/seguros/backend/node_modules/express/lib/router/layer.js:95:5)\n    at /home/jaquezrd/Programas/seguros/backend/node_modules/express/lib/router/index.js:284:15","timestamp":"2026-02-12T00:38:11.919Z"}
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."role"::text FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."user_id" = $1 AND "public"."company_users"."company_id" = $2 AND "public"."company_users"."is_active" = $3) LIMIT $4 OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."companies"."id" FROM "public"."companies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."legal_name", "public"."companies"."rnc", "public"."companies"."email", "public"."companies"."phone", "public"."companies"."address", "public"."companies"."logo", "public"."companies"."settings", "public"."companies"."status"::text, "public"."companies"."trial_ends_at", "public"."companies"."created_at", "public"."companies"."updated_at", COALESCE("aggr_selection_0_CompanyUser"."_aggr_count_companyUsers", 0) AS "_aggr_count_companyUsers", COALESCE("aggr_selection_1_Client"."_aggr_count_clients", 0) AS "_aggr_count_clients", COALESCE("aggr_selection_2_Policy"."_aggr_count_policies", 0) AS "_aggr_count_policies", COALESCE("aggr_selection_3_Claim"."_aggr_count_claims", 0) AS "_aggr_count_claims" FROM "public"."companies" LEFT JOIN (SELECT "public"."company_users"."company_id", COUNT(*) AS "_aggr_count_companyUsers" FROM "public"."company_users" WHERE 1=1 GROUP BY "public"."company_users"."company_id") AS "aggr_selection_0_CompanyUser" ON ("public"."companies"."id" = "aggr_selection_0_CompanyUser"."company_id") LEFT JOIN (SELECT "public"."clients"."company_id", COUNT(*) AS "_aggr_count_clients" FROM "public"."clients" WHERE 1=1 GROUP BY "public"."clients"."company_id") AS "aggr_selection_1_Client" ON ("public"."companies"."id" = "aggr_selection_1_Client"."company_id") LEFT JOIN (SELECT "public"."policies"."company_id", COUNT(*) AS "_aggr_count_policies" FROM "public"."policies" WHERE 1=1 GROUP BY "public"."policies"."company_id") AS "aggr_selection_2_Policy" ON ("public"."companies"."id" = "aggr_selection_2_Policy"."company_id") LEFT JOIN (SELECT "public"."claims"."company_id", COUNT(*) AS "_aggr_count_claims" FROM "public"."claims" WHERE 1=1 GROUP BY "public"."claims"."company_id") AS "aggr_selection_3_Claim" ON ("public"."companies"."id" = "aggr_selection_3_Claim"."company_id") WHERE 1=1 ORDER BY "public"."companies"."created_at" DESC LIMIT $1 OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."role"::text FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."user_id" = $1 AND "public"."company_users"."company_id" = $2 AND "public"."company_users"."is_active" = $3) LIMIT $4 OFFSET $5
prisma:query UPDATE "public"."users" SET "active_company_id" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: BYPASS, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: BYPASS, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" < $2) ORDER BY "public"."payments"."due_date" ASC OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."payments"."policy_id") WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."due_date" >= $2 AND "public"."payments"."due_date" <= $3 AND ("j0"."status" <> CAST($4::text AS "public"."PolicyStatus") AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."payments"."due_date" ASC LIMIT $5 OFFSET $6
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("estimated_amount") AS "_sum$estimated_amount" FROM (SELECT "public"."claims"."estimated_amount" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."renewals"."id" FROM "public"."renewals" WHERE "public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE "public"."claims"."status" IN (CAST($1::text AS "public"."ClaimStatus"),CAST($2::text AS "public"."ClaimStatus"),CAST($3::text AS "public"."ClaimStatus")) OFFSET $4) AS "sub"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT SUM("premium") AS "_sum$premium" FROM (SELECT "public"."policies"."premium" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."clients"."id" FROM "public"."clients" WHERE "public"."clients"."status" = CAST($1::text AS "public"."ClientStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."payments"."id" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."commissions"."amount" FROM "public"."commissions" WHERE "public"."commissions"."status" = CAST($1::text AS "public"."CommissionStatus") OFFSET $2) AS "sub"
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE "public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE "public"."policies"."status" = CAST($1::text AS "public"."PolicyStatus") OFFSET $2) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."policies"."id" FROM "public"."policies" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT COUNT(*) AS "_count$_all" FROM (SELECT "public"."claims"."id" FROM "public"."claims" WHERE 1=1 OFFSET $1) AS "sub"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."claims"."id", "public"."claims"."company_id", "public"."claims"."policy_id", "public"."claims"."claim_number", "public"."claims"."type", "public"."claims"."date_occurred", "public"."claims"."date_reported", "public"."claims"."description", "public"."claims"."estimated_amount", "public"."claims"."approved_amount", "public"."claims"."status"::text, "public"."claims"."priority"::text, "public"."claims"."assigned_to", "public"."claims"."created_at", "public"."claims"."updated_at" FROM "public"."claims" WHERE 1=1 ORDER BY "public"."claims"."created_at" DESC LIMIT $1 OFFSET $2
prisma:query SELECT SUM("amount") AS "_sum$amount" FROM (SELECT "public"."payments"."amount" FROM "public"."payments" WHERE ("public"."payments"."status" = CAST($1::text AS "public"."PaymentStatus") AND "public"."payments"."payment_date" >= $2 AND "public"."payments"."payment_date" <= $3) OFFSET $4) AS "sub"
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3,$4,$5) OFFSET $6
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."company_id", "public"."clients"."type"::text, "public"."clients"."name", "public"."clients"."cedula_rnc", "public"."clients"."phone", "public"."clients"."phone_alt", "public"."clients"."email", "public"."clients"."address", "public"."clients"."city", "public"."clients"."province", "public"."clients"."contact_person", "public"."clients"."contact_position", "public"."clients"."purchasing_manager", "public"."clients"."birth_date", "public"."clients"."status"::text, "public"."clients"."notes", "public"."clients"."created_by", "public"."clients"."user_id", "public"."clients"."created_at", "public"."clients"."updated_at" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."company_id", "public"."insurers"."name", "public"."insurers"."rnc", "public"."insurers"."legal_name", "public"."insurers"."phone", "public"."insurers"."email", "public"."insurers"."contact_person", "public"."insurers"."address", "public"."insurers"."status"::text, "public"."insurers"."created_at", "public"."insurers"."updated_at" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3,$4) OFFSET $5
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."renewals"."id", "public"."renewals"."company_id", "public"."renewals"."policy_id", "public"."renewals"."original_end_date", "public"."renewals"."new_end_date", "public"."renewals"."new_premium", "public"."renewals"."status"::text, "public"."renewals"."processed_by", "public"."renewals"."created_at" FROM "public"."renewals" LEFT JOIN "public"."policies" AS "j0" ON ("j0"."id") = ("public"."renewals"."policy_id") WHERE ("public"."renewals"."status" = CAST($1::text AS "public"."RenewalStatus") AND ("j0"."status" NOT IN (CAST($2::text AS "public"."PolicyStatus")) AND ("j0"."id" IS NOT NULL))) ORDER BY "public"."renewals"."original_end_date" ASC OFFSET $3
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."policies"."id", "public"."policies"."policy_number", "public"."policies"."status"::text, "public"."policies"."premium", "public"."policies"."end_date", "public"."policies"."auto_renew", "public"."policies"."client_id", "public"."policies"."insurer_id" FROM "public"."policies" WHERE "public"."policies"."id" IN ($1,$2,$3) OFFSET $4
prisma:query SELECT "public"."clients"."id", "public"."clients"."name", "public"."clients"."email", "public"."clients"."phone" FROM "public"."clients" WHERE "public"."clients"."id" IN ($1,$2) OFFSET $3
prisma:query SELECT "public"."insurers"."id", "public"."insurers"."name" FROM "public"."insurers" WHERE "public"."insurers"."id" IN ($1,$2,$3) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query BEGIN
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id" FROM "public"."companies" WHERE ("public"."companies"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query INSERT INTO "public"."tasks" ("company_id","title","description","completed","priority","due_date","user_id","created_at","updated_at") VALUES ($1,$2,$3,$4,CAST($5::text AS "public"."TaskPriority"),$6,$7,$8,$9) RETURNING "public"."tasks"."id"
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."id" = $1 LIMIT $2 OFFSET $3
prisma:query COMMIT
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:error 
Invalid `prisma.event.create()` invocation in
/home/jaquezrd/Programas/seguros/backend/src/modules/events/events.service.ts:169:38

  166 }
  167 
  168 async create(input: CreateEventInput) {
â†’ 169   const event = await prisma.event.create({
          data: {
            title: "ðŸ“‹ dfdfg",
            description: "Tarea pendiente",
            startDate: new Date("2026-06-12T12:00:00.000Z"),
            endDate: new Date("2026-06-12T12:00:00.000Z"),
            allDay: true,
            type: "REMINDER",
            color: "#14b8a6",
            userId: 1,
            policyId: null,
            clientId: null,
        +   company: {
        +     create: CompanyCreateWithoutEventsInput | CompanyUncheckedCreateWithoutEventsInput,
        +     connectOrCreate: CompanyCreateOrConnectWithoutEventsInput,
        +     connect: CompanyWhereUniqueInput
        +   }
          },
          include: {
            user: {
              select: {
                id: true,
                name: true
              }
            },
            policy: {
              select: {
                id: true,
                policyNumber: true
              }
            },
            client: {
              select: {
                id: true,
                name: true
              }
            }
          }
        })

Argument `company` is missing.
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE ("public"."tasks"."id" = $1 AND "public"."tasks"."user_id" = $2) LIMIT $3 OFFSET $4
prisma:query UPDATE "public"."tasks" SET "title" = $1, "description" = $2, "priority" = CAST($3::text AS "public"."TaskPriority"), "due_date" = $4, "updated_at" = $5 WHERE ("public"."tasks"."id" = $6 AND 1=1) RETURNING "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT 1
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE ("public"."tasks"."id" = $1 AND "public"."tasks"."user_id" = $2) LIMIT $3 OFFSET $4
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query UPDATE "public"."tasks" SET "title" = $1, "description" = $2, "priority" = CAST($3::text AS "public"."TaskPriority"), "due_date" = $4, "updated_at" = $5 WHERE ("public"."tasks"."id" = $6 AND 1=1) RETURNING "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at"
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query SELECT "public"."events"."id", "public"."events"."company_id", "public"."events"."title", "public"."events"."description", "public"."events"."start_date", "public"."events"."end_date", "public"."events"."all_day", "public"."events"."type"::text, "public"."events"."color", "public"."events"."user_id", "public"."events"."policy_id", "public"."events"."client_id", "public"."events"."created_at", "public"."events"."updated_at" FROM "public"."events" WHERE (("public"."events"."start_date" >= $1 AND "public"."events"."start_date" <= $2) OR ("public"."events"."end_date" >= $3 AND "public"."events"."end_date" <= $4)) OFFSET $5
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."policies"."id", "public"."policies"."company_id", "public"."policies"."policy_number", "public"."policies"."client_id", "public"."policies"."insurer_id", "public"."policies"."insurance_type_id", "public"."policies"."start_date", "public"."policies"."end_date", "public"."policies"."premium", "public"."policies"."payment_method"::text, "public"."policies"."number_of_installments", "public"."policies"."status"::text, "public"."policies"."auto_renew", "public"."policies"."beneficiary_data", "public"."policies"."commission_rate", "public"."policies"."notes", "public"."policies"."created_by", "public"."policies"."created_at", "public"."policies"."updated_at" FROM "public"."policies" WHERE ("public"."policies"."end_date" >= $1 AND "public"."policies"."end_date" <= $2 AND "public"."policies"."status" = CAST($3::text AS "public"."PolicyStatus")) OFFSET $4
prisma:query SELECT "public"."payments"."id", "public"."payments"."company_id", "public"."payments"."policy_id", "public"."payments"."client_id", "public"."payments"."amount", "public"."payments"."payment_method", "public"."payments"."payment_date", "public"."payments"."due_date", "public"."payments"."receipt_number", "public"."payments"."status"::text, "public"."payments"."notes", "public"."payments"."concept", "public"."payments"."reminder_days", "public"."payments"."reminder_sent", "public"."payments"."created_by", "public"."payments"."created_at" FROM "public"."payments" WHERE ("public"."payments"."due_date" >= $1 AND "public"."payments"."due_date" <= $2 AND "public"."payments"."status" = CAST($3::text AS "public"."PaymentStatus")) OFFSET $4
[AUTH] Tenant context cleared after request
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT 1
prisma:query SELECT "public"."tasks"."id", "public"."tasks"."company_id", "public"."tasks"."title", "public"."tasks"."description", "public"."tasks"."completed", "public"."tasks"."priority"::text, "public"."tasks"."due_date", "public"."tasks"."user_id", "public"."tasks"."created_at", "public"."tasks"."updated_at" FROM "public"."tasks" WHERE "public"."tasks"."user_id" = $1 ORDER BY "public"."tasks"."completed" ASC, "public"."tasks"."priority" DESC, "public"."tasks"."due_date" ASC OFFSET $2
[AUTH] Tenant context cleared after request
8:42:05 p.Â m. [tsx] change in ./src/modules/events/events.controller.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:42:06.170Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:42:06.188Z"}
8:42:18 p.Â m. [tsx] change in ./src/modules/events/events.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:42:19.233Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:42:19.249Z"}
8:42:31 p.Â m. [tsx] change in ./src/modules/events/events.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:42:31.783Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:42:31.800Z"}
8:42:46 p.Â m. [tsx] change in ./src/modules/events/events.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:42:46.612Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:42:46.629Z"}
8:42:59 p.Â m. [tsx] change in ./src/modules/events/events.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:42:59.581Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:42:59.598Z"}
8:43:08 p.Â m. [tsx] change in ./src/modules/events/events.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:43:08.936Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:43:08.953Z"}
8:43:14 p.Â m. [tsx] change in ./src/modules/events/events.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:43:15.281Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:43:15.298Z"}
8:43:35 p.Â m. [tsx] change in ./src/modules/events/events.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:43:36.477Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:43:36.494Z"}
8:43:53 p.Â m. [tsx] change in ./src/modules/events/events.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:43:53.600Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:43:53.619Z"}
8:44:03 p.Â m. [tsx] change in ./src/modules/events/events.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:44:03.790Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:44:03.807Z"}
8:44:12 p.Â m. [tsx] change in ./src/modules/events/events.service.ts Restarting...
c[TENANT ISOLATION] Tenant isolation context system initialized
[TENANT ISOLATION] Isolation enforced at service layer via context
[32minfo[39m: SeguroPro API running on port 3000 {"timestamp":"2026-02-12T00:44:13.498Z"}
Policy expiration reminders job scheduled (daily at 8:00 AM)
Payment reminders job scheduled (daily at 9:00 AM)
[32minfo[39m: Scheduled jobs initialized {"timestamp":"2026-02-12T00:44:13.516Z"}
[AUTH] Attempting to verify token, token length: 802
[AUTH] Token first 50 chars: eyJhbGciOiJFUzI1NiIsImtpZCI6ImQwN2QwMDU0LTE4ODEtND
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context set - CompanyId: 2, Role: SUPER_ADMIN
[AUTH] User authenticated - Email: admin@corredora.com.do, Role: SUPER_ADMIN, CompanyId: 2, ID: 1
prisma:query UPDATE "public"."users" SET "last_login" = $1, "updated_at" = $2 WHERE ("public"."users"."id" = $3 AND 1=1) RETURNING "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at"
prisma:query SELECT "public"."users"."id", "public"."users"."supabase_user_id", "public"."users"."name", "public"."users"."email", "public"."users"."role"::text, "public"."users"."phone", "public"."users"."status"::text, "public"."users"."force_password_change", "public"."users"."active_company_id", "public"."users"."last_login", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."supabase_user_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."company_users"."id", "public"."company_users"."user_id", "public"."company_users"."company_id", "public"."company_users"."role"::text, "public"."company_users"."is_active", "public"."company_users"."created_at", "public"."company_users"."updated_at" FROM "public"."company_users" WHERE ("public"."company_users"."is_active" = $1 AND "public"."company_users"."user_id" IN ($2)) OFFSET $3
prisma:query SELECT "public"."companies"."id", "public"."companies"."name", "public"."companies"."slug", "public"."companies"."status"::text FROM "public"."companies" WHERE "public"."companies"."id" IN ($1,$2) OFFSET $3
[AUTH] Tenant context cleared after request
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
prisma:error Error in PostgreSQL connection: Error { kind: Closed, cause: None }
